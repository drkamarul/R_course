library(VGAM)
?vglm
?vglm
args(vglm)
library(nnet)
?multinom
?multinom
?vglm
library(tidyverse)
library(haven)
dat.m1 <- read_dta('mammog9.dta')
glimpse(dat.m1)
head(dat.m1)
summary(dat.m1)
dat.m1$me2 <- factor(dat.m1$me,
labels = c("never","within.a.year","over.a.year.ago"))
levels(dat.m1$me2)
dat.m1$hist2 <- factor(dat.m1$hist, labels = c("no","yes"))
levels(dat.m1$hist2)
library(psych)
describe(dat.m1)
dat.m1 %>% count(me2)
dat.m1 %>% count(me2, hist2)
dat.m1$me3 <- factor(dat.m1$me2,
levels = c('over.a.year.ago','within.a.year','never'))
levels(dat.m1$me3)
levels(dat.m1$me3)
library(VGAM)
fitmlog1 <- vglm(me3 ~ hist2, multinomial, data = dat.m1)
summary(fitmlog1)
dat.m1$detc2 <- factor(dat.m1$detc)
table(dat.m1$me2, dat.m1$detc2)
levels(dat.m1$me3)
fitmlog2 <- vglm(me3 ~ detc2, multinomial, data = dat.m1)
summary(fitmlog2)
b_fitmlog2 <- coef(fitmlog2)
ci_fitmlog2 <- confint(fitmlog2)
b_ci_fitmlog2 <- cbind(b_fitmlog2, ci_fitmlog2)
b_ci_fitmlog2
rrr_fitmlog2 <- exp(b_ci_fitmlog2)
tab_fitmlog2 <- cbind(b_ci_fitmlog2, rrr_fitmlog2)
colnames(tab_fitmlog2) <- c('b', 'lower b', 'upper b', 'rrr',
'lower rrr', 'upper rrr')
tab_fitmlog2
fitmlog3 <- vglm(me3 ~ factor(sympt) + pb + hist2 + bse + detc2,
multinomial, data = dat.m1)
summary(fitmlog3)
dat.m1 %>% count(sympt)
dat.m1$symptd <- ifelse(dat.m1$sympt<3, '<3', '3 or more')
dat.m1 %>% count(symptd)
fitmlog4 <- vglm(me3 ~ symptd + pb + hist2 + bse + detc2,
multinomial, data = dat.m1)
summary(fitmlog4)
b_fitmlog4 <- coef(fitmlog4)
ci_fitmlog4 <- confint(fitmlog4)
cbind(b_fitmlog4, ci_fitmlog4)
dat.m1$detcd <- ifelse(dat.m1$detc<3, '<3', '3 or more')
fitmlog5 <- vglm(me3 ~ symptd + pb + hist2 + bse + detcd,
multinomial, data = dat.m1)
summary(fitmlog5)
b_rrr_fitmlog5 <- cbind(coef(fitmlog5), exp(coef(fitmlog5)))
ci_b_rrr.fitmlog5 <- cbind(confint(fitmlog5), exp(confint(fitmlog5)))
res_fitmlog5 <- cbind(b_rrr_fitmlog5, ci_b_rrr.fitmlog5)
colnames(res_fitmlog5) <- c('b', 'rrr', 'lower 95% b','upper 95% b', 'lower 95% rrr' , 'upper b95% rrr')
res_fitmlog5
library(knitr)
library(kableExtra)
kable(res_fitmlog5, format = 'latex', digits = 2)
summary(fitmlog1)
head(predict.vgam(fitmlog1, type = 'link'))
# ptn 1: hist2 = no
# logit me3=over a year ago = [1]  vs me3= never =[3]
-1.2504928 +  1.0093308*0
# logit me3=within a year = [2]  vs me3= never =[3]
-0.9509763 + 1.2563579 *0
# ptn 3: hist2 = yes
# logit me3=over a year ago = [1]  vs me3= never =[3]
-1.2504928 +  1.0093308*1
# logit me3=within a year = [2]  vs me3= never =[3]
-0.9509763 + 1.2563579*1
head(predict.vgam(fitmlog1, type = 'response'))
# probability being in the reference group (me3 == never = [3])
1/(1 + exp(-1.2504928) + exp(-0.9509763))
# probability being in the over a year ago group (me3 == over a year ago = [2])
exp(-1.2504928)/(1 + exp(-1.2504928) + exp(-0.9509763))
# probability being in the within a year group (me3 == within a year = [1])
exp(-0.9509763)/(1 + exp(-1.2504928) + exp(-0.9509763))
library(nnet)
mlog_nnet <- multinom(me3 ~ hist2, data = dat.m1)
summary(mlog_nnet)
gator <- read.table('gator.txt', header=TRUE)
head(gator)
levels(gator$Lake)
contrasts(gator$Lake) <- contr.treatment(levels(gator$Lake), base=2)
contrasts(gator$Lake)
levels(gator$Lake)
fit.gat<-vglm(cbind(Bird,Invertebrate,Reptile,Other,Fish)~Lake+Size+Gender, data=gator, family=multinomial)
summary(fit.gat)
library(foreign)
dat.m2 <- read.dta('APS.dta', convert.factors = TRUE)
names(dat.m2)
summary(dat.m2)
levels(dat.m2$place3)
library(VGAM)
dat.m2$place3b <- factor(dat.m2$place3, c("one","two","zero"))
levels(dat.m2$place3b)
fit.m2 <- vglm(place3b ~ age + race + dangerd + behav +
custd, multinomial, data = dat.m2)
summary(fit.m2)
exp(coef(fit.m2))
library(nnet)
fit.m3<-multinom(place3 ~ age + race + dangerd + behav +
custd, data = dat.m2)
summary(fit.m3)
head(dat.m1)
glipmse(dat.m1)
glimpse(dat.m1)
dat.m1 %>% select(me, me3) %>% head()
dat.m1$me2
head(dat.m1$me2)
dat.m1 %>% select(me, me2) %>% head()
dat.m1 <- dat.m1 %>%
mutate(m4 = fct_relevel(me2,
levels = c('over.a.year.ago','within.a.year','never')))
dat.m1 <- dat.m1 %>%
mutate(m4 = m2) %>% fct_relevel(me2,
levels = c('over.a.year.ago','within.a.year','never'))
dat.m1 <- dat.m1 %>%
mutate(m4 = m2) %>% fct_relevel(me4,
levels = c('over.a.year.ago','within.a.year','never'))
dat.m1 <- dat.m1 %>% mutate(m4 = m2)
dat.m1 <- dat.m1 %>% mutate(m4 = me2)
dat.m1
dat.m1$m4 %>%
fct_relevel('over.a.year.ago','within.a.year','never') %>%
levels()
dat.m1 %>% select(me, me2, me3, me4) %>% head()
dat.m1 <- dat.m1 %>% mutate(me3 = me2)
dat.m1$me3 %>%
fct_relevel('over.a.year.ago','within.a.year','never') %>%
levels()
dat.m1 %>% select(me, me2, me3) %>% head()
dat.m1 %>% select(me, me2, me3) %>% str()
dat.m1 %>% select(me, me2, me3) %>% class()
dat.m1 %>% select(me, me2, me3) %>% str()
str(dat.m1$me2)
str(dat.m1$me2)
levels(dat.m1$me2)
levels(dat.m1$me3)
levels(dat.m1$me2)
levels(dat.m1$me2) ; levels(dat.m1$me3)
dat.m1 <- dat.m1 %>% mutate(me3 = me2)
dat.m1$me3 %>%
fct_relevel('over.a.year.ago','within.a.year','never') %>%
levels()
dat.m1 %>% select(me, me2, me3) %>% head()
levels(dat.m1$me2) ; levels(dat.m1$me3)
dat.m1$me4 %>%
fct_relevel('over.a.year.ago','within.a.year','never') %>%
levels()
dat.m1$me3 %>%
fct_relevel('over.a.year.ago','within.a.year','never') %>%
levels()
library(forcats)
dat.m1$me3 %>%
fct_relevel('over.a.year.ago','within.a.year','never') %>%
levels()
dat.m1 %>% select(me, me2, me3) %>% head()
levels(dat.m1$me2) ; levels(dat.m1$me3)
dat.m1$me3 <- fct_relevel(dat.m1$me3, 'over.a.year.ago','within.a.year','never') %>%
levels()
dat.m1$me3 <- fct_relevel(dat.m1$me3, c('over.a.year.ago','within.a.year','never')) %>%
levels()
dat.m1$me3 <- fct_relevel(dat.m1$me3,
levels = c('over.a.year.ago','within.a.year','never'))
dat.m1$me3 <- fct_relevel(dat.m1$me3,levels= c('over.a.year.ago','within.a.year','never'))
dat.m1$me3 %>%
fct_relevel('never','over.a.year.ago','within.a.year') %>%
levels()
levels(dat.m1$me2) ; levels(dat.m1$me3)
dat.m1$me2 %>% levels()
dat.m1 <- dat.m1 %>% mutate(me3 = me2)
dat.m1$me3 %>% levels()
dat.m1$me3 %>%
fct_relevel('over.a.year.ago','within.a.year') %>%
levels()
dat.m1$me3 %>%
fct_relevel('over.a.year.ago','within.a.year', 'never') %>%
levels()
dat.m1 %>% select(me, me2, me3) %>% head()
dat.m1 %>% select(me, me2, me3) %>% str()
levels(dat.m1$me2) ; levels(dat.m1$me3)
dat.m1 <- dat.m1 %>% mutate(me3 = me2)
dat.m1$me3 %>% levels()
dat.m1$me3 %>% levels()
dat.m1$me3 %>%
fct_relevel('within.a.year', 'never') %>%
levels()
dat.m1$me3 %>%
fct_relevel("over.a.year.ago", 'within.a.year', 'never') %>%
levels()
dat.m1$me3 %>% levels()
dat.m1$me3 %>%
fct_relevel("over.a.year.ago", 'within.a.year', 'never') %>%
levels()
levels(dat.m1$me2) ; levels(dat.m1$me3)
dat.m1$me3 <- dat.m1$me3 %>%
fct_relevel("over.a.year.ago", 'within.a.year', 'never') %>%
levels()
dat.m1$me3 %>% levels()
dat.m1 <- dat.m1 %>% mutate(me3 = me2)
dat.m1$me3 <- dat.m1$me3 %>%
fct_relevel("over.a.year.ago", 'within.a.year', 'never') %>%
levels()
dat.m1$me3 <-
dat.m1$me3 %>%
fct_relevel("over.a.year.ago", 'within.a.year', 'never') %>%
levels()
dat.m1$me3 %>%
fct_relevel("over.a.year.ago", 'within.a.year', 'never') %>%
levels()
dat.m1 %>% select(me, me2, me3) %>% head()
levels(dat.m1$me2) ; levels(dat.m1$me3)
labels(dat.m1$me2) ; labels(dat.m1$me3)
levels(dat.m1$me2) ; levels(dat.m1$me3)
str(dat.m1$me2) ; str(dat.m1$me3)
dat.m1 <- dat.m1 %>%
mutate(me3 = fct_relevel(me2, c("over.a.year.ago", 'within.a.year', 'never')))
levels(dat.m1$me2) ; levels(dat.m1$me3)
dat.m1 %>% select(me, me2, me3) %>% head()
levels(dat.m1$me2) ; levels(dat.m1$me3)
dat.m1$me2 %>% levels()
dat.m1 <- dat.m1 %>%
mutate(me3 = fct_relevel(me2, c("over.a.year.ago", 'within.a.year', 'never')))
dat.m1 %>% select(me, me2, me3) %>% head()
levels(dat.m1$me2) ; levels(dat.m1$me3)
